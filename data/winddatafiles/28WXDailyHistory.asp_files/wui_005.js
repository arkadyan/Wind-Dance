var wui={};wui.global=this;(function(a,b){var c=[];a.toggleVisibility=function(g){c.include(g);for(var f=0;f<c.length;f++){var d=c[f];var e=b(d);if(!e){continue}else{if(d===g){e.toggleClass("none")}else{e.addClass("none")}}}};a.centerInWindow=function(d){var h=b(d);if(!h){return}h.setStyles({position:"absolute",top:0,left:0});var j=false;if(h.hasClass("none")){j=true;h.removeClass("none")}var e=window.getWidth();var l=window.getHeight();var f=h.getSize().size.x;var i=h.getSize().size.y;var k=(l-i)/2;var g=(e-f)/2;h.setStyles({top:k,left:g});if(j){h.addClass("none")}};a.dropdown=function(d){this.options=b.extend(true,{selectorButton:null,selectorMenu:null,position:{my:"left top",at:"left bottom",of:null,offset:"0 0",collision:"none none"},delay:100,hoverClass:null},d?d:{});this.options.position.of=this.options.selectorButton;var e=b(this.options.selectorButton);var f=b(this.options.selectorMenu);b.data(f,"hover",false);var d=this.options;e.mouseenter(function(g){f.stop(true).show();e.addClass(d.hoverClass);f.addClass(d.hoverClass);if(!b.data(f,"hover")){f.css({position:"absolute",top:"0px",left:"0px","z-index":1000});f.position(d.position)}if(StickerPopUp){StickerPopUp.forceHide()}}).mouseleave(function(g){f.delay(d.delay).hide(0);e.removeClass(d.hoverClass);f.removeClass(d.hoverClass)});f.mouseenter(function(g){b.data(f,"hover",true);e.mouseenter()}).mouseleave(function(g){b.data(f,"hover",false);e.mouseleave()})};b(document).ready(function(){b("#optionBar").mouseenter(function(d){b("#pageHeader").addClass("headerOver").removeClass("headerOff")}).mouseleave(function(d){b("#pageHeader").addClass("headerOff").removeClass("headerOver")});b("#picCred").mouseenter(function(d){b("#geoData").fadeTo("slow",0)}).mouseleave(function(d){b("#geoData").fadeTo("slow",1)});new a.dropdown({selectorButton:"#socialMore",selectorMenu:"#socialList",position:{my:"right top",at:"right bottom"},hoverClass:"hover",delay:0});new a.dropdown({selectorButton:"#quickMenu",selectorMenu:"#quickMenuDropdown",position:{my:"left top",at:"left bottom"},hoverClass:"hover",delay:0});new a.dropdown({selectorButton:"#conds_details_radar .imageContain",selectorMenu:"#conds_details_radar_overlay",position:{my:"center center",at:"center center"},delay:0});new a.dropdown({selectorButton:"#wximage_img",selectorMenu:"#wximage_overlay",position:{my:"center center",at:"center center"},delay:0});if(b.browser.msie&&(parseInt(b.browser.version.charAt(0))<8||(document.documentMode&&document.documentMode==7))){b("#featureMenu .featureGroup .fullList").css("margin-top",-2)}b("#comments .text .postContent IMG").each(function(f){var e=b(this);e.css("max-width",501);var g=500;var d=e.width();if(d>g){e.width(g)}e.bind("load",function(i){var h=e.width();if(h>g){e.width(g)}})})});if(b.tablesorter){b.tablesorter.addParser({id:"englishNumber",is:function(d,e){return false},format:function(d){return b.tablesorter.formatFloat(d.replace(new RegExp(/[,]/g),""))},type:"numeric"})}})(wui,jQuery);(function(a,b){a.geolocation=function(){if(navigator&&navigator.geolocation){navigator.geolocation.getCurrentPosition(c)}function c(d){var f=d.coords.latitude;var g=d.coords.longitude;if(a.geolocation.getURL){var e=a.geolocation.getURL(f,g);window.location=e}else{window.location.search="query="+f+","+g}}}})(wui,jQuery);(function(a,c){var b={};a.log=function(d){a.log.write(d)};a.log.initialize=function(){b.container=c("<div></div>").addClass("wui-log").appendTo(document.body).css({position:"absolute",bottom:"1em",left:"1em"});b.container_head=c("<div></div>").addClass("wui-log-head").appendTo(b.container).html("wui.log");b.container_body=c("<div></div>").addClass("wui-log-body").appendTo(b.container);var d=c("<a></a>").addClass("wui-log-close").appendTo(b.container_head).html("X");d.attr("href","javascript:void(0);");d.click(function(f){f.preventDefault();a.log.remove()});b.container.draggable({handle:b.container_head});b.initialized=true};a.log.write=function(g){if(!b.initialized){a.log.initialize()}var f=new Date();var e=((f.getMilliseconds()/1000).toFixed(3)+"").substr(2);var d='<span class="wui-log-time">'+f.toLocaleTimeString()+"."+e+"</span>";var h=c("<div></div>").addClass("wui-log-row").html(d+" "+g);h.appendTo(b.container_body)};a.log.remove=function(){b.container.remove();b.initialized=false}})(wui,jQuery);(function(a,b){var c={};a.history={};a.history.toQueryString=function(){var g="#";var d=[];for(var e in c){if(c.hasOwnProperty(e)){var f=c[e];d.push(e+"="+encodeURIComponent(f))}}if(d.length>0){g+="?"+d.join("&")}return g};a.history.setKey=function(d,e){c[d]=e};a.history.getKey=function(d){return c[d]};a.history.replace=function(){var d=a.history.toQueryString();window.location.replace(d)};a.history.update=function(){var d=a.history.toQueryString();window.location=d};a.history.parse=function(){var j=window.location.hash;if(j.length>2&&j.charAt(0)=="#"&&j.charAt(1)=="?"){j=j.substr(2);var d=j.split("&");for(var f=0;f<d.length;f++){var g=d[f].split("=",2);var e=g[0];var h=decodeURIComponent(g[1]);c[e]=h}}};a.history.parse()})(wui,jQuery);(function(a,c){var b={activeClass:"active",disabledClass:"disabled",items:".fav-item",scroll:{},sortable:{},home:{}};a.favorites={};a.favorites.add=function(d){a.favorites._modify(d,"addfavorite",null)};a.favorites.del=function(d){a.favorites._modify(d,"delfavorite",null)};a.favorites.toggle=function(d,e){var g=c(e).hasClass(b.activeClass);var f=(g)?"delfavorite":"addfavorite";a.favorites._modify(d,f,e)};a.favorites._modify=function(d,g,f){var e="http://www.wunderground.com/favorites/submit.html?action="+g+"&place="+d;var f=c(f);c.ajax({url:e,type:"get",dataType:"jsonp",jsonp:"jsonp",success:function(i){var k="Error";var h=i.RESULTS||i;if(h.indexOf(k.toLowerCase())>=0){alert(h)}else{if(f[0]){var j=f.hasClass(b.activeClass);if(j){f.removeClass(b.activeClass)}else{f.addClass(b.activeClass)}}}},error:function(h){alert("Error: wui.favorites ajax request failed")}})};a.favorites._getActiveIndex=function(){var e=c(b.items);for(var d=0;d<e.length;d++){if(e.eq(d).hasClass(b.activeClass)){return d}}return -1};a.favorites.next=function(){var d=a.favorites._getActiveIndex();a.favorites.go(d+1)};a.favorites.prev=function(){var d=a.favorites._getActiveIndex();a.favorites.go(d-1)};a.favorites.go=function(d){var f=c(b.items);if(d<0){d=f.length-1}if(d>=f.length){d=0}var e=f.eq(d);if(e[0]){window.location=e.attr("href")}};a.favorites.scroll={};a.favorites.scroll.left=function(){a.favorites.scroll.calculateIndex();if(b.scroll.index>0){a.favorites.scroll.go(b.scroll.index-4)}};a.favorites.scroll.right=function(){a.favorites.scroll.calculateIndex();var d=b.scroll.items;if(b.scroll.index<d.length-1){a.favorites.scroll.go(b.scroll.index+4)}};a.favorites.scroll.snap=function(){a.favorites.scroll.calculateIndex();a.favorites.scroll.go(b.scroll.index)};a.favorites.scroll.go=function(d){if(d<0){d=0}else{if(d>b.scroll.items.length-1){d=b.scroll.items.length-1}}var e=b.scroll.items.eq(d);var f=e.position().left+b.scroll.container.scrollLeft();b.scroll.container.animate({scrollLeft:f},{duration:"slow",complete:function(){a.favorites.scroll.setButtons()}})};a.favorites.scroll.calculateIndex=function(){var d=b.scroll.items;for(var e=0;e<d.length;e++){if(d.eq(e).position().left+d.eq(e).width()/2>=0){b.scroll.index=e;break}}};a.favorites.scroll.setButtons=function(){var d=b.scroll.items;var f=d.eq(0);var e=d.eq(-1);if(!f[0]||f.position().left>=0){b.scroll.leftButton.addClass(b.disabledClass)}else{b.scroll.leftButton.removeClass(b.disabledClass)}if(!e[0]||e.position().left+e.width()<=b.scroll.container.width()){b.scroll.rightButton.addClass(b.disabledClass)}else{b.scroll.rightButton.removeClass(b.disabledClass)}};a.favorites.scroll.initialize=function(){b.scroll={index:0,bar:c("#favoritesBar"),container:c("#favoritesBar .favoritesScrollContainer"),items:c("#favoritesBar .favoritesItem"),leftButton:c("#favoritesBar .favoritesScrollLeft"),rightButton:c("#favoritesBar .favoritesScrollRight"),allButtons:c("#favoritesBar .favoritesScrollButtons"),title:c("#favoritesBar .favoritesTitle")};if(c.browser.msie&&parseInt(c.browser.version.charAt(0))<7){var f=parseFloat(b.scroll.bar.css("width")),h=b.scroll.title.outerWidth(),g=b.scroll.allButtons.outerWidth();var e=f-h-g;b.scroll.container.width(e)}a.favorites.scroll.setButtons();var d=b.scroll.container;d.mousedown(function(i){c(this).data("down",true).data("x",i.clientX).data("scrollLeft",this.scrollLeft);c(window).bind("mousemove.favorites",function(j){if(d.data("down")==true){d[0].scrollLeft=d.data("scrollLeft")+d.data("x")-j.clientX}});if(i.which===1){i.preventDefault()}c(window).one("mouseup.favorites",function(j){c(window).unbind("mousemove.favorites");if(d.data("down")==true){a.favorites.scroll.snap();a.favorites.scroll.setButtons()}d.data("down",false)})}).click(function(i){if(d.data("scrollLeft")!=d[0].scrollLeft){i.preventDefault()}})};a.favorites.sortable={};a.favorites.sortable.initialize=function(){b.sortable={dragClass:"favMove",draggableClass:"favCursorMove",loadingClass:"ajax-loading",deleteButtonClass:"deleteButton",index:0,list:c("#favorites-list"),items:c("#favorites-list li"),log:c("#log")};b.sortable.list.sortable({axis:"y",containment:b.sortable.list,distance:3,tolerance:"pointer",start:function(d,e){e.item.addClass(b.sortable.dragClass)},stop:function(d,e){e.item.removeClass(b.sortable.dragClass)},update:function(d,e){a.favorites.sortable.submit()}});b.sortable.items.each(function(d,e){a.favorites.sortable.setupItem(c(e))})};a.favorites.sortable.createItem=function(f,d){var e=c("<li></li>").attr("id",f).html(d);e.hide();e.appendTo(b.sortable.list);a.favorites.sortable.setupItem(e);e.fadeIn(2000);return e};a.favorites.sortable.setupItem=function(e){e.addClass(b.sortable.draggableClass);var d=c("<span></span>").addClass(b.sortable.deleteButtonClass);d.click(function(){c(e).remove();a.favorites.sortable.refresh();a.favorites.sortable.submit()});e.append(d)};a.favorites.sortable.refresh=function(){b.sortable.list.sortable("refresh")};a.favorites.sortable.submit=function(){var d="/favorites/submit.html";var e=","+b.sortable.list.sortable("toArray").join(",");a.favorites.sortable.setLoading(true,null,0);c.ajax({url:d,type:"post",data:{action:"reorderfavorites",order:e},dataType:"html",success:function(f){a.favorites.sortable.setLoading(false,f,3000)},error:function(f){var g="Error: wui.favorites.sortable ajax request failed";a.favorites.sortable.setLoading(false,g,0)}})};a.favorites.sortable.setLoading=function(f,g,d){var e=b.sortable.log;if(f==true){e.empty().addClass(b.sortable.loadingClass)}else{e.empty().removeClass(b.sortable.loadingClass)}if(g){e.html(g)}if(d){window.setTimeout(function(){e.empty()},d)}};a.favorites.home=function(d,e){b.home={activeClass:"active",inactiveClass:""};a.favorites.home._modify(d,e)};a.favorites.home.toggle=function(d,f,e,h){if(e||e===""){b.home.activeClass=e}if(h||h===""){b.home.inactiveClass=h}var g=c(f).hasClass(b.home.activeClass);if(g){d=""}a.favorites.home._modify(d,f)};a.favorites.home._modify=function(d,e){var e=c(e);c.ajax({url:"/auto/wui/geo/PrefDump/index.html?setprefs.0.key=USERHOME&setprefs.0.val="+d,type:"get",dataType:"html",success:function(f){if(e){if(e.hasClass(b.home.activeClass)==true){e.removeClass(b.home.activeClass).addClass(b.home.inactiveClass)}else{e.addClass(b.home.activeClass).removeClass(b.home.inactiveClass)}}},error:function(f){alert("Error: wui.favorites.home ajax request failed")}})};c(document).ready(function(){a.favorites.scroll.initialize();a.favorites.sortable.initialize()})})(wui,jQuery);(function(b,c){var a=[];var d=false;b.stickyscroll={};b.stickyscroll.add=function(e){var f=c.extend(true,{elt:null,top:0,until:0,isPosFixed:false,isPosAbsolute:false},e?e:{});var g=parseFloat(f.elt.css("marginTop"));f.originalTopOffset=f.elt.offset().top-f.top-g;if(f.until){f.originalBottomOffset=f.until-f.elt.outerHeight()}else{f.originalBottomOffset=c(document).height()-f.elt.outerHeight()-g}f.originalPosition=f.elt.css("position");f.originalTop=f.elt.css("top");a.push(f);b.stickyscroll.refresh()};b.stickyscroll.refresh=function(){if(!d&&a.length>0){d=true;c(window).bind("scroll.stickyscroll",function(){var e=c(window).scrollTop();for(var f=0;f<a.length;f++){var g=a[f];if(e>g.originalBottomOffset){if(g.isPosAbsolute){continue}g.isPosFixed=false;g.isPosAbsolute=true;g.elt.css({position:"absolute",top:g.originalBottomOffset})}else{if(e>g.originalTopOffset){if(g.isPosFixed){continue}g.isPosFixed=true;g.isPosAbsolute=false;g.elt.css({position:"fixed",top:g.top})}else{if(e<g.originalTopOffset){if(!g.isPosFixed&&!g.isPosAbsolute){continue}g.isPosFixed=false;g.isPosAbsolute=false;g.elt.css({position:g.originalPosition,top:g.originalTop})}}}}})}};b.stickyscroll.removeAll=function(){c(window).unbind("scroll.stickyscroll");a=[];d=false}})(wui,jQuery);